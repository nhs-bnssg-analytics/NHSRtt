<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Find the value of p1 that achieves a target waiting time percentile — find_p • NHSRtt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find the value of p1 that achieves a target waiting time percentile — find_p"><meta name="description" content="Uses a binary search algorithm to find the value of p1 (the proportion
parameter) that achieves a specified target waiting time (target_time)
at a given percentile (hardcoded as 92nd percentile) of the cumulative
waiting list size, given a treatment capacity in the first month
(mu_1) and other parameters."><meta property="og:description" content="Uses a binary search algorithm to find the value of p1 (the proportion
parameter) that achieves a specified target waiting time (target_time)
at a given percentile (hardcoded as 92nd percentile) of the cumulative
waiting list size, given a treatment capacity in the first month
(mu_1) and other parameters."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NHSRtt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/rtt-pipeline.html">Creating and validating a model</a></li>
    <li><a class="dropdown-item" href="../articles/animated-charts.html">Visualising projections</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Find the value of p1 that achieves a target waiting time percentile</h1>

      <div class="d-none name"><code>find_p.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Uses a binary search algorithm to find the value of <code>p1</code> (the proportion
parameter) that achieves a specified target waiting time (<code>target_time</code>)
at a given percentile (hardcoded as 92nd percentile) of the cumulative
waiting list size, given a treatment capacity in the first month
(<code>mu_1</code>) and other parameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">find_p</span><span class="op">(</span></span>
<span>  target_time <span class="op">=</span> <span class="fl">4</span> <span class="op">+</span> <span class="op">(</span><span class="fl">68</span><span class="op">/</span><span class="fl">487</span><span class="op">)</span>,</span>
<span>  <span class="va">renege_params</span>,</span>
<span>  <span class="va">mu_1</span>,</span>
<span>  p1_lower <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  p1_upper <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  <span class="va">referrals</span>,</span>
<span>  percentile <span class="op">=</span> <span class="fl">0.92</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-target-time">target_time<a class="anchor" aria-label="anchor" href="#arg-target-time"></a></dt>
<dd><p>numeric of length 1; the target waiting time,
in months, to achieve the specified percentile.</p></dd>


<dt id="arg-renege-params">renege_params<a class="anchor" aria-label="anchor" href="#arg-renege-params"></a></dt>
<dd><p>numeric; proportion (0 ≤ r<sub>m</sub> &amp;leq; 1)
of waiting patients reneging in the m-th month of waiting, where r<sub>2</sub> = 0.1
refers to 10% of those in the second month of waiting reneging.</p></dd>


<dt id="arg-mu-">mu_1<a class="anchor" aria-label="anchor" href="#arg-mu-"></a></dt>
<dd><p>numeric of length 1; treatment capacity in the first month.</p></dd>


<dt id="arg-p-lower">p1_lower<a class="anchor" aria-label="anchor" href="#arg-p-lower"></a></dt>
<dd><p>numeric of length 1; lower bound for the binary search of <code>p1</code>.
Must be between 0 and 1 and less than  <code>p1_upper</code>. Defaults to 0.1.</p></dd>


<dt id="arg-p-upper">p1_upper<a class="anchor" aria-label="anchor" href="#arg-p-upper"></a></dt>
<dd><p>numeric of length 1; upper bound for the binary search of <code>p1</code>.
Must be between 0 and 1 and more than  <code>p1_lower</code>. Defaults to 0.85.</p></dd>


<dt id="arg-tolerance">tolerance<a class="anchor" aria-label="anchor" href="#arg-tolerance"></a></dt>
<dd><p>numeric of length 1; tolerance for the binary search stopping
criterion. The unit is months.</p></dd>


<dt id="arg-referrals">referrals<a class="anchor" aria-label="anchor" href="#arg-referrals"></a></dt>
<dd><p>numeric of length 1; value representing the steady-state number
of referrals.</p></dd>


<dt id="arg-percentile">percentile<a class="anchor" aria-label="anchor" href="#arg-percentile"></a></dt>
<dd><p>Numeric value between 0 and 1 indicating the desired percentile (default is 0.92).</p></dd>


<dt id="arg-max-iterations">max_iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>numeric of length 1; maximum number of iterations to
search for a valid result</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p>
<dl><dt>p1</dt>
<dd><p>The value of <code>p1</code> found to achieve
  the target waiting time.</p></dd>
 <dt>time_p</dt>
<dd><p>The interpolated waiting time at
  the specified percentile.</p></dd>
 <dt>mu</dt>
<dd><p>The total number of treatments required
  when the solution is found.</p></dd>
 <dt>wlsize</dt>
<dd><p>The total size of the waiting list
  when the solution is found.</p></dd>
 <dt>waiting_list</dt>
<dd><p>The data frame with historical data
  formatted and waiting list sizes calculated.</p></dd>
 <dt>niterations</dt>
<dd><p>The number
  of iterations performed in the binary search.</p></dd>
 <dt>status</dt>
<dd><p>Converged indicates a
  solution was found, and Not converged indicates no solution was found</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function repeatedly uses the removals table (from <code><a href="initialise_removals.html">initialise_removals()</a></code>)
  and calculates waiting list sizes for candidate values of <code>p1</code>, using binary search to
  home in on the value that achieves the target waiting time at the required
  percentile. The search stops when the difference between upper and lower
  bounds is less than <code>tolerance</code>, or when the calculated waiting time is
  within <code>tolerance</code> of the target.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="initialise_removals.html">initialise_removals</a></code>, <code><a href="calc_wl_sizes.html">calc_wl_sizes</a></code>,
  <code><a href="hist_percentile_calc.html">hist_percentile_calc</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">find_p</span><span class="op">(</span></span></span>
<span class="r-in"><span>  target_time <span class="op">=</span> <span class="fl">4</span> <span class="op">+</span> <span class="op">(</span><span class="fl">68</span> <span class="op">/</span> <span class="fl">487</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  renege_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.04</span>, <span class="fl">0.04</span>, <span class="fl">0.03</span>, <span class="fl">0.01</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  mu_1 <span class="op">=</span> <span class="fl">2651.227</span>,</span></span>
<span class="r-in"><span>  p1_lower <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>  p1_upper <span class="op">=</span> <span class="fl">0.85</span>,</span></span>
<span class="r-in"><span>  tolerance <span class="op">=</span> <span class="fl">0.001</span>,</span></span>
<span class="r-in"><span>  referrals <span class="op">=</span> <span class="fl">12000</span>,</span></span>
<span class="r-in"><span>  percentile <span class="op">=</span> <span class="fl">0.92</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $p1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8200623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $time_p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4.139275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mu</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10836.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $wlsize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24630.12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $waiting_list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   months_waited_id    r   service     sigma    wlsize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                0 0.04 2651.2270 2651.2270 8868.7730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                1 0.04 2174.1712 2174.1712 6339.8509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                2 0.03 1782.9557 1782.9557 4366.6996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                3 0.01 1462.1347 1462.1347 2860.8979</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                4 0.02 1199.0415 1199.0415 1604.6385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                5 0.02  983.2887  983.2887  589.2571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7                6 0.01 4377.9222  583.3645    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $niterations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $status</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Converged"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Fox, Richard Wood, Richard Blackwell, Simon Wellesley-Miller, Neil Walton.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

